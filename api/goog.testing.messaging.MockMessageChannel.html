---
{edit_path: '', layout: api, page: goog.testing.messaging.MockMessageChannel, section: 2-api}
---
{% raw %}
<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><title>MockMessageChannel</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><button class="dossier-menu"><i class="material-icons">menu</i></button><form><input type="search" placeholder="Search" tabindex="1"><i class="material-icons">search</i></form></header><div class="content"><main><article><section class="intro"><div class="header"><div class="parentlink"><b>Namespace:</b> <a href="goog.testing.messaging.html">goog.testing.messaging</a></div><div class="codelink"><a href="https://github.com/google/closure-library/blob/master/closure/goog/testing/messaging/mockmessagechannel.js#L38" target="_blank">View Source</a></div><h1 class="title"><div class="tags"><span class="final"></span></div><div>class MockMessageChannel</div></h1></div><div class="body"><pre class="inheritance"><a href="goog.Disposable.html">goog.Disposable</a>
  &#x2514; <a href="goog.messaging.AbstractChannel.html">goog.messaging.AbstractChannel</a>
      &#x2514; goog.testing.messaging.MockMessageChannel</pre><dl><dt class="spec">All implemented interfaces<dd><code><a href="goog.disposable.IDisposable.html">goog.disposable.IDisposable</a></code><dd><code><a href="goog.messaging.MessageChannel.html">goog.messaging.MessageChannel</a></code></dl><p>Class for unit-testing code that communicates over a MessageChannel.</p>
<h3 class="name"><div>new MockMessageChannel(<var>mockControl</var>)</div></h3><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>mockControl</var><code><a href="goog.testing.MockControl.html">goog.testing.MockControl</a></code><dd><p>The mock control used to create
the method mock for #send.</p>
</dl></dd></div></section><section class="instance-methods"><h2>Instance Methods</h2><section class="property expandable" id="addOnDisposeCallback"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/disposable/disposable.js#L216" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div><var class="template">&lt;T&gt;</var> addOnDisposeCallback(<var>callback</var>, <var>opt_scope</var>)</div></h3></div><div class="body"><p>Invokes a callback function when this object is disposed. Callbacks are
invoked in the order in which they were added. If a callback is added to
an already disposed Disposable, it will be called immediately.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.Disposable.html#addOnDisposeCallback">goog.Disposable</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>callback</var><code>function(this: T): ?</code><dd><p>The callback function.</p>
<dt class="type name"><var>opt_scope</var><code>T=</code><dd><p>An optional scope to call the callback in.</p>
</dl></dd></dl></div></section><section class="property expandable" id="connect"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L78" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>connect(<var>opt_connectCb</var>)</div></h3></div><div class="body"><p>Immediately calls opt_connectCb if given, and is otherwise a no-op. If
subclasses have configuration that needs to happen before the channel is
connected, they should override this and <a href="goog.testing.messaging.MockMessageChannel.html#isConnected"><code>#isConnected</code></a>.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#connect">goog.messaging.AbstractChannel</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.messaging.MessageChannel.html#connect">goog.messaging.MessageChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>opt_connectCb</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">Function</a>=</code><dd><p>Called when the channel has been connected
and is ready to use.</p>
</dl></dd></dl></div></section><section class="property expandable" id="decodePayload"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L185" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="protected"></span></div><div>decodePayload(<var>serviceName</var>, <var>payload</var>, <var>objectPayload</var>)</div></h3></div><div class="body"><p>Converts the message payload into the format expected by the registered
service (either JSON or string).</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#decodePayload">goog.messaging.AbstractChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>serviceName</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The name of the service receiving the message.</p>
<dt class="type name"><var>payload</var><code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code><dd><p>The contents of the message.</p>
<dt class="type name"><var>objectPayload</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the service expects an object or a
plain string.</p>
</dl></dd><dt class="spec">Returns</dt><dd><dl><dt class="type"><code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code><dd><p>The payload in the format expected by the service, or
null if something went wrong.</p>
</dl></dd></dl></div></section><section class="property expandable" id="deliver"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L131" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="protected"></span></div><div>deliver(<var>serviceName</var>, <var>payload</var>)</div></h3></div><div class="body"><p>Delivers a message to the appropriate service. This is meant to be called by
subclasses when they receive messages.</p>
<p>This method takes into account both explicitly-registered and default
services, as well as making sure that JSON payloads are decoded when
necessary. If the subclass is capable of passing objects as payloads, those
objects can be passed in to this method directly. Otherwise, the (potentially
JSON-encoded) strings should be passed in.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#deliver">goog.messaging.AbstractChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>serviceName</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The name of the service receiving the message.</p>
<dt class="type name"><var>payload</var><code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code><dd><p>The contents of the message.</p>
</dl></dd></dl></div></section><section class="property expandable" id="dispose"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/testing/messaging/mockmessagechannel.js#L68" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>dispose()</div></h3></div><div class="body"><p>Sets a flag indicating that this is disposed.</p>
<dl><dt class="spec">Overrides</dt><dd><a href="goog.Disposable.html#dispose">goog.Disposable</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.disposable.IDisposable.html#dispose">goog.disposable.IDisposable</a></dd><dt class="spec">Returns</dt><dd><dl><dt class="type"><code><a href=".globals.html#PredicateFunctionType">PredicateFunctionType</a></code><dd><p>Nothing.</p>
</dl></dd></dl></div></section><section class="property expandable" id="disposeInternal"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L204" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="protected"></span></div><div>disposeInternal()</div></h3></div><div class="body"><p>Deletes or nulls out any references to COM objects, DOM nodes, or other
disposable objects. Classes that extend <code>goog.Disposable</code> should
override this method.
Not reentrant. To avoid calling it twice, it must only be called from the
subclass&#39; <code>disposeInternal</code> method. Everywhere else the public
<code>dispose</code> method must be used.
For example:</p>
 <pre>
   mypackage.MyClass &#61; function() {
     mypackage.MyClass.base(this, &#39;constructor&#39;);
     // Constructor logic specific to MyClass.
     ...
   };
   goog.inherits(mypackage.MyClass, goog.Disposable);

   mypackage.MyClass.prototype.disposeInternal &#61; function() {
     // Dispose logic specific to MyClass.
     ...
     // Call superclass&#39;s disposeInternal at the end of the subclass&#39;s, like
     // in C&#43;&#43;, to avoid hard-to-catch issues.
     mypackage.MyClass.base(this, &#39;disposeInternal&#39;);
   };
 </pre>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#disposeInternal">goog.messaging.AbstractChannel</a></dd><dt class="spec">Overrides</dt><dd><a href="goog.Disposable.html#disposeInternal">goog.Disposable</a></dd></dl></div></section><section class="property expandable" id="getDisposed"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/disposable/disposable.js#L163" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="deprecated"></span></div><div>getDisposed()</div></h3></div><div class="body"><dl><dt class="spec">Deprecated<dd><p>Use <a href="goog.testing.messaging.MockMessageChannel.html#isDisposed"><code>#isDisposed</code></a> instead.</p>
<dt class="spec">Defined by</dt><dd><a href="goog.Disposable.html#getDisposed">goog.Disposable</a></dd><dt class="spec">Returns</dt><dd><dl><dt class="type"><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the object has been disposed of.</p>
</dl></dd></dl></div></section><section class="property expandable" id="getService"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L157" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="protected"></span></div><div>getService(<var>serviceName</var>, <var>payload</var>)</div></h3></div><div class="body"><p>Find the service object for a given service name. If there&#39;s no service
explicitly registered, but there is a default service, a service object is
constructed for it.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#getService">goog.messaging.AbstractChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>serviceName</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The name of the service receiving the message.</p>
<dt class="type name"><var>payload</var><code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code><dd><p>The contents of the message.</p>
</dl></dd><dt class="spec">Returns</dt><dd><dl><dt class="type"><code>?{callback: function((<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)): ?, objectPayload: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>}</code><dd><p>The
service object for the given service, or null if none was found.</p>
</dl></dd></dl></div></section><section class="property expandable" id="isConnected"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L91" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>isConnected()</div></h3></div><div class="body"><p>Always returns true. If subclasses have configuration that needs to happen
before the channel is connected, they should override this and
<a href="goog.testing.messaging.MockMessageChannel.html#connect"><code>#connect</code></a>.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#isConnected">goog.messaging.AbstractChannel</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.messaging.MessageChannel.html#isConnected">goog.messaging.MessageChannel</a></dd><dt class="spec">Returns</dt><dd><dl><dt class="type"><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the channel is connected.</p>
</dl></dd></dl></div></section><section class="property expandable" id="isDisposed"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/disposable/disposable.js#L154" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>isDisposed()</div></h3></div><div class="body"><dl><dt class="spec">Defined by</dt><dd><a href="goog.Disposable.html#isDisposed">goog.Disposable</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.disposable.IDisposable.html#isDisposed">goog.disposable.IDisposable</a></dd><dt class="spec">Returns</dt><dd><dl><dt class="type"><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the object has been disposed of.</p>
</dl></dd></dl></div></section><section class="property expandable" id="receive"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/testing/messaging/mockmessagechannel.js#L78" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>receive(<var>serviceName</var>, <var>payload</var>)</div></h3></div><div class="body"><p>Mocks the receipt of a message. Passes the payload the appropriate service.</p>
<dl><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>serviceName</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The service to run.</p>
<dt class="type name"><var>payload</var><code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code><dd><p>The argument to pass to the service.</p>
</dl></dd></dl></div></section><section class="property expandable" id="registerDefaultService"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L107" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>registerDefaultService(<var>callback</var>)</div></h3></div><div class="body"><p>Registers a service to be called when a message is received that doesn&#39;t
match any other services.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#registerDefaultService">goog.messaging.AbstractChannel</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.messaging.MessageChannel.html#registerDefaultService">goog.messaging.MessageChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>callback</var><code>function(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>, (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>))</code><dd><p>The callback to process
the incoming messages. Passed the service name and the payload. Since
some channels can pass objects natively, the payload may be either an
object or a string.</p>
</dl></dd></dl></div></section><section class="property expandable" id="registerDisposable"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/disposable/disposable.js#L203" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>registerDisposable(<var>disposable</var>)</div></h3></div><div class="body"><p>Associates a disposable object with this object so that they will be disposed
together.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.Disposable.html#registerDisposable">goog.Disposable</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>disposable</var><code><a href="goog.disposable.IDisposable.html">goog.disposable.IDisposable</a></code><dd><p>that will be disposed when
this object is disposed.</p>
</dl></dd></dl></div></section><section class="property expandable" id="registerService"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L97" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>registerService(<var>serviceName</var>, <var>callback</var>, <var>opt_objectPayload</var>)</div></h3></div><div class="body"><p>Registers a service to be called when a message is received.</p>
<p>Implementers shouldn&#39;t impose any restrictions on the service names that may
be registered. If some services are needed as control codes,
<a href="goog.messaging.html"><code>goog.messaging.MultiMessageChannel</code></a> can be used to safely split the
channel into &#34;public&#34; and &#34;control&#34; virtual channels.</p>
<dl><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#registerService">goog.messaging.AbstractChannel</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.messaging.MessageChannel.html#registerService">goog.messaging.MessageChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>serviceName</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The name of the service.</p>
<dt class="type name"><var>callback</var><code>function((<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>))</code><dd><p>The callback to process the
incoming messages. Passed the payload. If opt_objectPayload is set, the
payload is decoded and passed as an object.</p>
<dt class="type name"><var>opt_objectPayload</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>=</code><dd><p>If true, incoming messages for this
service are expected to contain an object, and will be deserialized from
a string automatically if necessary. It&#39;s the responsibility of
implementors of this class to perform the deserialization.</p>
</dl></dd></dl></div></section><section class="property expandable" id="send"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/testing/messaging/mockmessagechannel.js#L60" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>send(<var>serviceName</var>, <var>payload</var>)</div></h3></div><div class="body"><p>A mock send function. Actually an instance of
<a href="goog.testing.FunctionMock.html"><code>goog.testing.FunctionMock</code></a>.</p>
<dl><dt class="spec">Overrides</dt><dd><a href="goog.messaging.AbstractChannel.html#send">goog.messaging.AbstractChannel</a></dd><dt class="spec">Specified by</dt><dd><a href="goog.messaging.MessageChannel.html#send">goog.messaging.MessageChannel</a></dd><dt class="spec">Parameters</dt><dd><dl><dt class="type name"><var>serviceName</var><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The name of the remote service to run.</p>
<dt class="type name"><var>payload</var><code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|!<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code><dd><p>The payload to send to the remote page.</p>
</dl></dd></dl></div></section></section><section class="instance-properties"><h2>Instance Properties</h2><section class="property expandable" id="creationStack"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/disposable/disposable.js#L147" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="const"></span></div><div>creationStack</div></h3></div><div class="body"><p>If monitoring the goog.Disposable instances is enabled, stores the creation
stack trace of the Disposable instance.</p>
<dl><dt class="spec">Type<dd><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></dd><dt class="spec">Defined by</dt><dd><a href="goog.Disposable.html#creationStack">goog.Disposable</a></dd></dl></div></section><section class="property expandable" id="disposed"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/testing/messaging/mockmessagechannel.js#L45" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div>disposed</div></h3></div><div class="body"><p>Whether the channel has been disposed.</p>
<dl><dt class="spec">Type<dd><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></dd></dl></div></section><section class="property expandable" id="logger"><div class="header"><div class="code-link"><a href="https://github.com/google/closure-library/blob/master/closure/goog/messaging/abstractchannel.js#L68" target="_blank" title="View source"><i class="material-icons">code</i></a></div><h3 class="name"><div class="tags"><span class="protected"></span></div><div>logger</div></h3></div><div class="body"><p>Logger for this class.</p>
<dl><dt class="spec">Type<dd><a href="goog.log.Logger.html">goog.log.Logger</a></dd><dt class="spec">Defined by</dt><dd><a href="goog.messaging.AbstractChannel.html#logger">goog.messaging.AbstractChannel</a></dd></dl></div></section></section></article></main><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer></div><nav class="dossier-nav"><section><a class="title" href="index.html" tabindex="2">Overview</a></section><section class="types"><div class="toggle"><div class="title"><span class="item" tabindex="2">Types</span><i class="material-icons">expand_more</i></div></div></section></nav><script src="types.js"></script><script src="dossier.js"></script>
{% endraw %}
